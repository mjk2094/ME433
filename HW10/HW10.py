import csv
import matplotlib.pyplot as plt # for plotting
import numpy as np # for sine function


t = [] # column 0
data1 = [] # column 1
data2 = [] # column 2

filtered = []
new_average = [0]

with open('sigC.csv') as f:
    # open the csv file
    reader = csv.reader(f)
    for row in reader:
        # read the rows 1 one by one
        t.append(float(row[0])) # leftmost column
        data1.append(float(row[1])) # second column
        #data2.append(float(row[2])) # third column

total_time = t[-1] - t[0]
sample_rate = len(t)/total_time

h = [
    0.000000000000000000,
    0.000000012507050829,
    0.000000064206973727,
    -0.000000185811528770,
    -0.000000094205011667,
    0.000000594873203815,
    -0.000000214141085287,
    -0.000001032554148141,
    0.000001059329949899,
    0.000001055383861000,
    -0.000002326086278621,
    -0.000000186931497024,
    0.000003501484530574,
    -0.000001792399429342,
    -0.000003785957598623,
    0.000004593237050110,
    0.000002393950195708,
    -0.000007333371154412,
    0.000001045875576772,
    0.000008706425981732,
    -0.000006142964972845,
    -0.000007398959150421,
    0.000011613874149209,
    0.000002648915568418,
    -0.000015482011778635,
    0.000005242728946499,
    0.000015618523080808,
    -0.000014660860028815,
    -0.000010506500143914,
    0.000022850501047568,
    -0.000000000000000001,
    -0.000026562361701110,
    0.000014201266145927,
    0.000023055915650814,
    -0.000028602570710231,
    -0.000011194140047941,
    0.000038601161075263,
    -0.000007726938628179,
    -0.000039726251245431,
    0.000029758495217739,
    0.000029143446233670,
    -0.000048903130329873,
    -0.000006985243075011,
    0.000058530046441530,
    -0.000022965692815425,
    -0.000053320756444849,
    0.000053601556492085,
    0.000031236515558748,
    -0.000075933887943315,
    0.000005110504407592,
    0.000081435961871548,
    -0.000048234244227837,
    -0.000064736456048140,
    0.000087000413073667,
    0.000025903532841361,
    -0.000109210141524381,
    0.000028458981207686,
    0.000105017323251100,
    -0.000085862944178158,
    -0.000070305077167846,
    0.000130466306900310,
    0.000009001050386601,
    -0.000147071640389371,
    0.000066551386240194,
    0.000125670083583946,
    -0.000137623212758768,
    -0.000065285954441888,
    0.000183354610736717,
    -0.000024127945561634,
    -0.000186372084335323,
    0.000122630332250699,
    0.000138362276893161,
    -0.000204268951649458,
    -0.000043979676466776,
    0.000243445783740764,
    -0.000078311561989540,
    -0.000222223913558427,
    0.000199196041627639,
    0.000136630777460982,
    -0.000285019542225436,
    0.000000000000000009,
    0.000306551125723952,
    -0.000158055955853533,
    -0.000247849835639276,
    0.000297414196453286,
    0.000112741284107144,
    -0.000377028909189162,
    0.000073278202890542,
    0.000366198576744769,
    -0.000266913640670971,
    -0.000254591125358736,
    0.000416464879762786,
    0.000058041204462470,
    -0.000474897086840469,
    0.000182095371703714,
    0.000413455933175669,
    -0.000406744761632836,
    -0.000232113983658443,
    0.000552887273738295,
    -0.000036482250677493,
    -0.000570286615944278,
    0.000331529442741792,
    0.000436943205895820,
    -0.000576921219726257,
    -0.000168839322042548,
    0.000699984559501488,
    -0.000179448159407018,
    -0.000651703985895309,
    0.000524606187157078,
    0.000423071947507787,
    -0.000773537258554617,
    -0.000052599415437642,
    0.000847355259424398,
    -0.000378165066366925,
    -0.000704494988831770,
    0.000761357886225889,
    0.000356527688436975,
    -0.000988696256946868,
    0.000128500970546031,
    0.000980609032096687,
    -0.000637606249281461,
    -0.000711081840459693,
    0.001037901622506457,
    0.000220983489544889,
    -0.001209939143184295,
    0.000385068315479041,
    0.001081305181804834,
    -0.000959349191568593,
    -0.000651439505302150,
    0.001345609350207632,
    -0.000000000000000041,
    -0.001419862441473901,
    0.000725323116142152,
    0.001127119720505320,
    -0.001340559725922456,
    -0.000503769364120625,
    0.001670428995270597,
    -0.000321967626065867,
    -0.001595940706924399,
    0.001154015356170503,
    0.001092200172727081,
    -0.001773096963466747,
    -0.000245280040610627,
    0.001992384944579893,
    -0.000758571720289483,
    -0.001710514936500126,
    0.001671457619310035,
    0.000947602843327943,
    -0.002242793565662015,
    0.000147074777743672,
    0.002285231101589620,
    -0.001320736843252866,
    -0.001730827381073516,
    0.002272781779665908,
    0.000661615708461472,
    -0.002728920628633810,
    0.000696132270211387,
    0.002516137967349139,
    -0.002016187049469352,
    -0.001618855664668398,
    0.002947514868024805,
    0.000199628377601223,
    -0.003203765087123976,
    0.001424685752810745,
    0.002645139555896272,
    -0.002849606213437087,
    -0.001330481577000217,
    0.003679548289613979,
    -0.000477037731525738,
    -0.003632102145452092,
    0.002356862914190069,
    0.002623780449195362,
    -0.003823840693445998,
    -0.000813114823150775,
    0.004447543586944064,
    -0.001414421846557560,
    -0.003970065848729212,
    0.003521781119277716,
    0.002391819565074436,
    -0.004942870735775411,
    0.000000000000000075,
    0.005225780118509015,
    -0.002673538730800700,
    -0.004162318368448692,
    0.004961679476622919,
    0.001869501928212346,
    -0.006218076167753950,
    0.001202720753099880,
    0.005985409000812286,
    -0.004347333458118495,
    -0.004134932371934595,
    0.006749717318808322,
    0.000939392205423521,
    -0.007681535422098215,
    0.002946013783758308,
    0.006696037620125308,
    -0.006600040213934599,
    -0.003777152635963511,
    0.009031556113042368,
    -0.000598850258977160,
    -0.009417042675341231,
    0.005513551353578517,
    0.007327534226487134,
    -0.009768875905671773,
    -0.002890739334691343,
    0.012136358513317208,
    -0.003155818119499271,
    -0.011645618489491230,
    0.009543698721444564,
    0.007851916438922630,
    -0.014679595901504998,
    -0.001023241901094863,
    0.016944814498889977,
    -0.007797805169205173,
    -0.015031276983973019,
    0.016874628557531596,
    0.008245173928438619,
    -0.023980047925730157,
    0.003288124155007539,
    0.026657172153402443,
    -0.018567149015377728,
    -0.022404958570816973,
    0.035826053071786788,
    0.008488875899432155,
    -0.052801334970387928,
    0.019635043670306319,
    0.067107292584387898,
    -0.077292741538296447,
    -0.076650021828447726,
    0.308286014117796769,
    0.580000002649019075,
    0.308286014117796769,
    -0.076650021828447726,
    -0.077292741538296447,
    0.067107292584387898,
    0.019635043670306319,
    -0.052801334970387928,
    0.008488875899432155,
    0.035826053071786795,
    -0.022404958570816976,
    -0.018567149015377728,
    0.026657172153402443,
    0.003288124155007541,
    -0.023980047925730160,
    0.008245173928438619,
    0.016874628557531596,
    -0.015031276983973019,
    -0.007797805169205173,
    0.016944814498889977,
    -0.001023241901094863,
    -0.014679595901504998,
    0.007851916438922628,
    0.009543698721444564,
    -0.011645618489491230,
    -0.003155818119499271,
    0.012136358513317208,
    -0.002890739334691343,
    -0.009768875905671775,
    0.007327534226487134,
    0.005513551353578519,
    -0.009417042675341231,
    -0.000598850258977160,
    0.009031556113042368,
    -0.003777152635963512,
    -0.006600040213934600,
    0.006696037620125309,
    0.002946013783758308,
    -0.007681535422098215,
    0.000939392205423521,
    0.006749717318808325,
    -0.004134932371934595,
    -0.004347333458118495,
    0.005985409000812284,
    0.001202720753099880,
    -0.006218076167753950,
    0.001869501928212346,
    0.004961679476622920,
    -0.004162318368448694,
    -0.002673538730800700,
    0.005225780118509016,
    0.000000000000000075,
    -0.004942870735775412,
    0.002391819565074437,
    0.003521781119277715,
    -0.003970065848729213,
    -0.001414421846557560,
    0.004447543586944064,
    -0.000813114823150775,
    -0.003823840693445998,
    0.002623780449195362,
    0.002356862914190070,
    -0.003632102145452093,
    -0.000477037731525738,
    0.003679548289613979,
    -0.001330481577000217,
    -0.002849606213437089,
    0.002645139555896273,
    0.001424685752810745,
    -0.003203765087123976,
    0.000199628377601223,
    0.002947514868024805,
    -0.001618855664668399,
    -0.002016187049469352,
    0.002516137967349139,
    0.000696132270211387,
    -0.002728920628633811,
    0.000661615708461472,
    0.002272781779665907,
    -0.001730827381073516,
    -0.001320736843252866,
    0.002285231101589621,
    0.000147074777743672,
    -0.002242793565662017,
    0.000947602843327944,
    0.001671457619310036,
    -0.001710514936500126,
    -0.000758571720289483,
    0.001992384944579895,
    -0.000245280040610627,
    -0.001773096963466748,
    0.001092200172727081,
    0.001154015356170504,
    -0.001595940706924399,
    -0.000321967626065867,
    0.001670428995270597,
    -0.000503769364120625,
    -0.001340559725922456,
    0.001127119720505320,
    0.000725323116142152,
    -0.001419862441473901,
    -0.000000000000000041,
    0.001345609350207632,
    -0.000651439505302150,
    -0.000959349191568594,
    0.001081305181804834,
    0.000385068315479041,
    -0.001209939143184295,
    0.000220983489544890,
    0.001037901622506458,
    -0.000711081840459693,
    -0.000637606249281462,
    0.000980609032096687,
    0.000128500970546031,
    -0.000988696256946867,
    0.000356527688436975,
    0.000761357886225889,
    -0.000704494988831770,
    -0.000378165066366926,
    0.000847355259424398,
    -0.000052599415437642,
    -0.000773537258554618,
    0.000423071947507787,
    0.000524606187157079,
    -0.000651703985895309,
    -0.000179448159407018,
    0.000699984559501489,
    -0.000168839322042548,
    -0.000576921219726257,
    0.000436943205895820,
    0.000331529442741792,
    -0.000570286615944278,
    -0.000036482250677493,
    0.000552887273738295,
    -0.000232113983658443,
    -0.000406744761632837,
    0.000413455933175668,
    0.000182095371703714,
    -0.000474897086840469,
    0.000058041204462470,
    0.000416464879762786,
    -0.000254591125358736,
    -0.000266913640670971,
    0.000366198576744769,
    0.000073278202890542,
    -0.000377028909189162,
    0.000112741284107144,
    0.000297414196453286,
    -0.000247849835639276,
    -0.000158055955853533,
    0.000306551125723952,
    0.000000000000000009,
    -0.000285019542225436,
    0.000136630777460982,
    0.000199196041627639,
    -0.000222223913558427,
    -0.000078311561989540,
    0.000243445783740764,
    -0.000043979676466776,
    -0.000204268951649458,
    0.000138362276893161,
    0.000122630332250699,
    -0.000186372084335323,
    -0.000024127945561634,
    0.000183354610736717,
    -0.000065285954441889,
    -0.000137623212758768,
    0.000125670083583946,
    0.000066551386240195,
    -0.000147071640389371,
    0.000009001050386601,
    0.000130466306900310,
    -0.000070305077167846,
    -0.000085862944178158,
    0.000105017323251100,
    0.000028458981207686,
    -0.000109210141524382,
    0.000025903532841361,
    0.000087000413073667,
    -0.000064736456048140,
    -0.000048234244227836,
    0.000081435961871548,
    0.000005110504407592,
    -0.000075933887943315,
    0.000031236515558748,
    0.000053601556492085,
    -0.000053320756444849,
    -0.000022965692815425,
    0.000058530046441530,
    -0.000006985243075011,
    -0.000048903130329873,
    0.000029143446233670,
    0.000029758495217739,
    -0.000039726251245431,
    -0.000007726938628179,
    0.000038601161075263,
    -0.000011194140047941,
    -0.000028602570710231,
    0.000023055915650814,
    0.000014201266145927,
    -0.000026562361701110,
    -0.000000000000000001,
    0.000022850501047568,
    -0.000010506500143914,
    -0.000014660860028815,
    0.000015618523080808,
    0.000005242728946499,
    -0.000015482011778635,
    0.000002648915568418,
    0.000011613874149209,
    -0.000007398959150421,
    -0.000006142964972845,
    0.000008706425981732,
    0.000001045875576772,
    -0.000007333371154412,
    0.000002393950195708,
    0.000004593237050110,
    -0.000003785957598623,
    -0.000001792399429342,
    0.000003501484530574,
    -0.000000186931497024,
    -0.000002326086278621,
    0.000001055383861000,
    0.000001059329949899,
    -0.000001032554148141,
    -0.000000214141085287,
    0.000000594873203815,
    -0.000000094205011667,
    -0.000000185811528770,
    0.000000064206973727,
    0.000000012507050829,
    0.000000000000000000,
]

for i in range(len(t)):
    avg = 0
    for j in range(len(h)):
        if (i-j) < 0:
            continue
        avg += h[j] * data1[i-j]
    filtered.append(avg)

### A/B Filter
"""
A = 0.3
B = 0.7
for i in range(len(t)):
    if (i+1) >= len(t):
        continue
    new_average.append(A*new_average[i] + B*data1[i+1])
"""
"""
## Moving Average Filter
length = 40
for i in range(len(t)):
    avg = 0
    for j in range(length):
        if (i+j) >= len(t):
            continue
        avg += data1[i+j]
    avg /= length
    filtered.append(avg)
"""

"""
for i in range(len(t)):
    # print the data to verify it was read
    #print(str(t[i]) + ", " + str(data1[i]) + ", " + str(data2[i]))
    print(str(t[i]) + ", " + str(data1[i]))
"""

#dt = 1.0/100.0 # 100Hz
#t = np.arange(0.0, 5.0, dt) # for 5s
#s = 2.0 * np.sin(2 * np.pi * 2.3 * t) + 2.5 # 2.3Hz

"""
plt.plot(t,data1,'')
plt.xlabel('Time [s]')
plt.ylabel('Signal')
plt.title('Signal vs Time')
plt.show()

### FFT

Fs = 10000 # sample rate
Ts = 1.0/Fs; # sampling interval
ts = np.arange(0,t[-1],Ts) # time vector
y = filtered # the data to make the fft from
n = len(y) # length of the signal
k = np.arange(n)
T = n/Fs
frq = k/T # two sides frequency range
frq = frq[range(int(n/2))] # one side frequency range
Y = np.fft.fft(y)/n # fft computing and normalization
Y = Y[range(int(n/2))]

fig, (ax1, ax2) = plt.subplots(2, 1)
ax1.plot(t,y,'b')
ax1.set_xlabel('Time')
ax1.set_ylabel('Amplitude')
ax2.loglog(frq,abs(Y),'b') # plotting the fft
ax2.set_xlabel('Freq (Hz)')
ax2.set_ylabel('|Y(freq)|')
plt.show()
"""

plt.plot(t,data1,linewidth=2,color='black')
plt.plot(t,filtered,linewidth=1,color='red')
plt.title('Signal C 461-Tap Blackman-Windowed Low Pass Filter (725Hz)')
plt.show()


